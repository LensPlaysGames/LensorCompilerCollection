* Zeal/Dash

** Update local docset

#+begin_src emacs-lisp
  (defun lens/install-docset (docset-path)
    (unless (file-directory-p docset-path)
      (error "You know what you did"))
    (delete-directory
     (concat "~/.local/share/Zeal/Zeal/docsets/"
             (file-name-nondirectory docset-path))
     t)
    (copy-directory docset-path "~/.local/share/Zeal/Zeal/docsets/"))
#+end_src

** Generate Sqlite Database

#+begin_src emacs-lisp
  (defun lens/sqlite-table-exists-p (db-object table-name)
    "Check if TABLE-NAME exists in the SQLite database DB-OBJECT."
    (let* ((query (format "SELECT name FROM sqlite_master WHERE type='table' AND name='%s'" table-name))
           (result (sqlite-select db-object query)))
      ;; If result is non-nil, the table exists
      (not (null result))))

  (let
      ((db (sqlite-open "Glint.docset/Contents/Resources/docSet.dsidx")))

    (sqlite-execute-batch
     db
     (concat
      "DROP TABLE IF EXISTS searchIndex;"
      "CREATE TABLE searchIndex(id INTEGER PRIMARY KEY, name TEXT, type TEXT, path TEXT);"
      "CREATE UNIQUE INDEX anchor ON searchIndex (name, type, path);"
      "INSERT OR IGNORE INTO searchIndex(name, type, path) VALUES ('The Book', 'Guide', 'thebook.html');"))

    (sqlite-close db))

  (lens/install-docset "Glint.docset")
#+end_src
